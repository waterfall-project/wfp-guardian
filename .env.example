# Flask Environment Configuration Example
# Copy this file to .env.development for local development
# In Docker/Production, these variables are set by docker-compose or orchestration tools

# =============================================================================
# Flask Configuration
# =============================================================================
FLASK_ENV=development
SERVICE_PORT=5000

# =============================================================================
# Logging Configuration
# =============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
# Log format: json or text
LOG_FORMAT=text

# =============================================================================
# JWT Configuration
# =============================================================================
JWT_SECRET_KEY=your-secret-key-change-in-production
JWT_ALGORITHM=HS256

# =============================================================================
# External Services Configuration
# =============================================================================
# Timeout for external services (Identity) in seconds
EXTERNAL_SERVICES_TIMEOUT=5

# Identity Service
IDENTITY_SERVICE_URL=http://localhost:8002
USE_IDENTITY_SERVICE=false

# Mock User Configuration (used when USE_IDENTITY_SERVICE is false)
MOCK_USER_ID=00000000-0000-0000-0000-000000000001
MOCK_COMPANY_ID=00000000-0000-0000-0000-000000000001

# =============================================================================
# Pagination Configuration
# =============================================================================
# Default page size when paginating results
PAGE_LIMIT=20
# Maximum allowed page size
MAX_PAGE_LIMIT=100

# =============================================================================
# Redis Cache Configuration
# =============================================================================
USE_REDIS_CACHE=false

# Option 1: Provide a complete REDIS_URL (recommended for production/cloud)
# Example: redis://username:password@localhost:6379/0
# REDIS_URL=redis://localhost:6379/0

# Option 2: Build Redis URL from individual components
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
# REDIS_PASSWORD=myredispassword

# Note: If REDIS_URL is provided, it takes precedence over individual components

# =============================================================================
# Database Configuration
# =============================================================================
# Option 1: Provide a complete DATABASE_URL (recommended for production/cloud)
# Examples:
#   PostgreSQL: postgresql://user:password@localhost:5432/dbname
#   MySQL: mysql+pymysql://user:password@localhost:3306/dbname
#   SQLite: sqlite:///path/to/database.db
# DATABASE_URL=postgresql://user:password@localhost:5432/mydb

# Option 2: Build database URL from individual components
# Database type: sqlite, postgresql, mysql
DATABASE_TYPE=sqlite
# For SQLite only: path to the database file (absolute or relative)
DATABASE_PATH=dev.db

# For PostgreSQL/MySQL: connection parameters
# DATABASE_HOST=localhost
# DATABASE_PORT=5432  # 5432 for PostgreSQL, 3306 for MySQL (auto-detected if not set)
# DATABASE_USER=myuser
# DATABASE_PASSWORD=mypassword
# DATABASE_NAME=mydatabase

# Note: In staging/production environments, you must provide either:
# - DATABASE_URL, OR
# - Complete connection parameters (TYPE, HOST, USER, PASSWORD, NAME) for postgresql/mysql
# SQLite is not allowed in staging/production.

# =============================================================================
# SQLAlchemy Configuration
# =============================================================================
# Database connection pool size
SQLALCHEMY_POOL_SIZE=5
# Time in seconds after which a connection is recycled
SQLALCHEMY_POOL_RECYCLE=3600
# Timeout in seconds for getting a connection from the pool
SQLALCHEMY_POOL_TIMEOUT=30
# Maximum overflow size of the pool
SQLALCHEMY_MAX_OVERFLOW=10
# Track modifications (set to false in production for performance)
SQLALCHEMY_TRACK_MODIFICATIONS=false

# =============================================================================
# CORS (Cross-Origin Resource Sharing) Configuration
# =============================================================================
# Enable/disable CORS
CORS_ENABLED=true
# Allowed origins (comma-separated list)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
# Allow credentials (cookies) in cross-origin requests
CORS_ALLOW_CREDENTIALS=true
# Cache duration for preflight requests in seconds
CORS_MAX_AGE=3600

# =============================================================================
# Rate Limiting Configuration
# =============================================================================
# Enable/disable rate limiting
RATE_LIMIT_ENABLED=true
# Rate limits: <number>/<period> (minute, hour, day)
RATE_LIMIT_LOGIN=100/minute
RATE_LIMIT_REFRESH=200/minute
RATE_LIMIT_VERIFY=500/minute
# Strategy: fixed-window, sliding-window, token-bucket
RATE_LIMIT_STRATEGY=fixed-window
# Storage: redis or memory (memory for tests only)
RATE_LIMIT_STORAGE=redis
# =============================================================================
# Testing Environment Configuration
# =============================================================================
# The application uses different .env files for different testing scenarios:
#
# 1. Unit Tests (.env.testing):
#    - Location: Project root
#    - Loaded by: tests/unit/conftest.py
#    - Purpose: Isolated unit tests with SQLite in-memory database
#    - Key settings:
#      * DATABASE_TYPE=sqlite, DATABASE_URL=sqlite:///memory
#      * USE_REDIS_CACHE=false (no external dependencies)
#      * USE_IDENTITY_SERVICE=false, USE_GUARDIAN_SERVICE=false
#      * RATE_LIMIT_ENABLED=false (testing without rate limits)
#    - Command: make test-unit
#
# 2. Integration Tests (.env.integration):
#    - Location: Project root
#    - Loaded by: tests/integration/conftest.py
#    - Purpose: Tests against real services in Docker containers
#    - Key settings:
#      * DATABASE_TYPE=postgresql (port 5433)
#      * USE_REDIS_CACHE=true (Redis on port 6380)
#      * USE_IDENTITY_SERVICE=true (port 5001)
#      * USE_GUARDIAN_SERVICE=true (port 5002)
#      * RATE_LIMIT_ENABLED=false (testing without rate limits)
#    - Services: Start with 'make test-integration-services-up'
#    - Command: make test-integration
#
# 3. Combined Testing:
#    - make test-cov: Run unit tests, flush Redis, then integration tests with coverage
#    - make test-all: Start services, run all tests with coverage, stop services
#    - make test: Run unit + integration (assumes services already running)
#
# Note: tests/unit/conftest.py sets environment variables BEFORE loading .env.testing
# to ensure proper isolation. tests/integration/conftest.py loads .env.integration
# with override=True to ensure integration-specific settings take precedence.
